module.exports = {
    extends: [
        'stylelint-config-css-modules',
        'stylelint-prettier/recommended',
        '@greenly/stylelint-config-rational-order',
    ],
    plugins: [
        'stylelint-csstree-validator',
        'stylelint-declaration-block-no-ignored-properties',
        'stylelint-no-unsupported-browser-features',
        'stylelint-z-index-value-constraint',
        'stylelint-prettier',
        'stylelint-order',
        '@greenly/stylelint-config-rational-order/plugin',
    ],
    customSyntax: require('postcss-scss'),
    rules: {
        // System
        'prettier/prettier': true,
        'csstree/validator': {
            syntaxExtensions: ['sass', 'less'],
        },

        // Supported features
        'at-rule-no-unknown': null,
        'unit-no-unknown': [
            true,
            {
                ignoreUnits: ['x'],
            },
        ],
        'property-no-unknown': true,
        'selector-pseudo-class-no-unknown': [
            true,
            {
                ignorePseudoClasses: ['local', 'global'],
            },
        ],
        'selector-pseudo-element-no-unknown': true,
        'selector-type-no-unknown': true,
        'selector-no-vendor-prefix': true,
        'selector-pseudo-class-disallowed-list': [
            'any',
            'any-link',
            'default',
            'defined',
            'dir',
            'host',
            'left',
            'right',
            'scope',
        ],
        'selector-pseudo-element-disallowed-list': [
            '/^-moz-/i',
            '/^-ms-/i',
            '/^-webkit-/i',
            'backdrop',
            'cue',
            'grammar-error',
            'spelling-error',
        ],
        'media-feature-name-disallowed-list': [
            'any-hover',
            'any-pointer',
            'color-gamut',
            'grid',
            'inverted-colors',
            'max-monochrome',
            'min-monochrome',
            'monochrome',
            'scripting',
            'update',
        ],
        'media-feature-name-no-vendor-prefix': true,
        'at-rule-disallowed-list': ['document', 'viewport', 'counter-style', 'font-feature-values'],
        'at-rule-no-vendor-prefix': true,
        'plugin/no-unsupported-browser-features': [
            true,
            {
                ignore: [
                    'flexbox',
                    'viewport-units',
                    'css-appearance',
                    'will-change',
                    'rem',
                    'pointer-events',
                    'font-unicode-range',
                    'outline',
                    'css-media-resolution',
                    'object-fit',
                    '::-webkit-media-controls-start-playback-button',
                    'css-featurequeries',
                    'word-break',
                    'css-resize',
                    'css-image-set',
                    'css-gradients',
                    'css-sticky',
                    'css-touch-action',
                    'pointer',
                    'calc',
                    'css-filters',
                    'multicolumn',
                    'intrinsic-width',
                ],
            },
        ],
        'media-feature-name-no-unknown': true,
        'function-disallowed-list': [
            'hsl',
            'hsla',
            'repeating-linear-gradient',
            'repeating-radial-gradient',
            'hwb',
            'inset',
            'matrix3d',
            'perspective',
            'polygon',
            'rotate3d',
            'scale3d',
            'symbols',
            'translate3d',
        ],
        'function-url-no-scheme-relative': true,
        'function-url-scheme-disallowed-list': ['data', 'ftp', 'file', '/^http/'],
        'unit-disallowed-list': ['ex', 'cm', 'mm', 'in', 'pt', 'pc', 'ch'],
        'value-no-vendor-prefix': [
            true,
            {
                ignoreValues: ['box'],
            },
        ],
        'property-disallowed-list': [
            'property-blacklist',
            'box-decoration-break',
            'break-after',
            'break-before',
            'break-inside',
            'clip',
            'hyphens',
            'hanging-punctuation',
            'image-orientation',
            'image-rendering',
            'image-resolution',
            'orphans',
            'perspective',
            'perspective-origin',
            'text-combine-upright',
        ],
        'property-no-vendor-prefix': [
            true,
            {
                ignoreProperties: ['line-clamp', 'box-orient', 'tap-highlight-color'],
            },
        ],

        // Invalid code
        'declaration-block-no-duplicate-properties': [
            true,
            {
                ignoreProperties: ['/background\\-/'],
            },
        ],
        'plugin/declaration-block-no-ignored-properties': true,
        'color-no-invalid-hex': true,
        'font-family-no-duplicate-names': true,
        'font-family-no-missing-generic-family-keyword': true,
        'no-duplicate-at-import-rules': true,
        'no-duplicate-selectors': true,
        'no-extra-semicolons': true,
        'no-invalid-double-slash-comments': true,

        // Code style
        'order/properties-order': [],
        'plugin/rational-order': [
            true,
            {
                'border-in-box-model': false,
                'empty-line-between-groups': true,
                'no-empty-lines-between-properties': true,
                severity: 'warning',
            },
        ],
        'function-calc-no-unspaced-operator': true,
        'function-linear-gradient-no-nonstandard-direction': true,
        'keyframe-declaration-no-important': true,
        'declaration-block-no-shorthand-property-overrides': true,
        'block-no-empty': true,
        'comment-no-empty': true,
        // TODO: remove
        'no-empty-source': true,
        'color-named': 'never',
        'color-no-hex': true,
        'number-max-precision': 2,
        'time-min-milliseconds': 100,
        'declaration-block-no-redundant-longhand-properties': true,
        'declaration-no-important': true,
        'declaration-block-single-line-max-declarations': 1,
        'selector-class-pattern': [
            '^.[a-z\\d-]+(?:__[a-z\\d-]+)?(?:_[a-z\\d-]+)?$',
            {
                resolveNestedSelectors: true,
            },
        ],
        'selector-id-pattern': '^[a-z]+(?:[a-z\\d-]+)?$',
        'selector-max-attribute': 2,
        'selector-max-class': 3,
        'selector-max-combinators': 3,
        'selector-max-compound-selectors': 3,
        'selector-max-id': 0,
        'selector-max-pseudo-class': 6,
        'selector-max-specificity': [
            '0,5,3',
            {
                ignoreSelectors: [':global', ':local'],
            },
        ],
        'selector-max-universal': 1,
        'selector-no-qualifying-type': [
            true,
            {
                ignore: ['attribute'],
            },
        ],
        'comment-word-disallowed-list': ['/^TODO:/', '/^@TODO:/'],
        'max-nesting-depth': [
            5,
            {
                ignore: ['blockless-at-rules'],
            },
        ],
        'color-hex-case': 'lower',
        'font-family-name-quotes': 'always-where-recommended',
        'function-comma-newline-after': 'never-multi-line',
        'function-comma-newline-before': 'never-multi-line',
        'function-comma-space-after': 'always',
        'function-comma-space-before': 'never',
        'plugin/z-index-value-constraint': [
            {
                min: 0,
                max: 10,
            },
            {
                ignoreValues: [20, 30, 100, 1000],
            },
        ],
        'function-name-case': 'lower',
        'function-parentheses-newline-inside': 'never-multi-line',
        'function-parentheses-space-inside': 'never',
        'function-url-quotes': 'always',
        'number-leading-zero': 'always',
        'number-no-trailing-zeros': true,
        'string-quotes': 'single',
        'unit-case': 'lower',
        'value-keyword-case': [
            'lower',
            {
                ignoreKeywords: ['/^U\\+[\\w-]+$/'],
            },
        ],
        'property-case': 'lower',
        'declaration-block-trailing-semicolon': 'always',
        'selector-attribute-quotes': 'always',
        'selector-descendant-combinator-no-non-space': true,
        'selector-pseudo-class-case': 'lower',
        'selector-pseudo-class-parentheses-space-inside': 'never',
        'selector-pseudo-element-case': 'lower',
        'selector-pseudo-element-colon-notation': 'double',
        'selector-type-case': 'lower',
        'at-rule-name-case': 'lower',

        // Indentation style
        indentation: 4,
        'max-empty-lines': 1,
        'no-eol-whitespace': true,
        'no-missing-end-of-source-newline': true,
        'comment-whitespace-inside': 'always',
        'string-no-newline': true,
        'selector-max-empty-lines': 0,
        'function-max-empty-lines': 0,
        'function-whitespace-after': 'always',
        'value-list-comma-newline-before': 'never-multi-line',
        'value-list-comma-space-before': 'never',
        'value-list-max-empty-lines': 0,
        'custom-property-empty-line-before': [
            'always',
            {
                except: ['after-comment', 'after-custom-property', 'first-nested'],
                ignore: ['first-nested'],
            },
        ],
        'declaration-bang-space-after': 'always',
        'declaration-bang-space-before': 'always',
        'declaration-colon-space-after': 'always',
        'declaration-colon-space-before': 'never',
        'declaration-empty-line-before': [
            'never',
            {
                ignore: ['after-comment', 'after-declaration'],
            },
        ],
        'declaration-block-semicolon-newline-after': 'always',
        'declaration-block-semicolon-newline-before': 'never-multi-line',
        'declaration-block-semicolon-space-after': 'always-single-line',
        'declaration-block-semicolon-space-before': 'never',
        'block-closing-brace-empty-line-before': 'never',
        'block-closing-brace-newline-after': 'always',
        'block-closing-brace-newline-before': 'always-multi-line',
        'block-opening-brace-newline-after': 'always-multi-line',
        'block-opening-brace-space-after': 'always-single-line',
        'block-opening-brace-space-before': 'always',
        'selector-attribute-brackets-space-inside': 'never',
        'selector-attribute-operator-space-after': 'never',
        'selector-attribute-operator-space-before': 'never',
        'selector-combinator-space-after': 'always',
        'selector-combinator-space-before': 'always',
        'selector-list-comma-newline-after': 'always',
        'selector-list-comma-newline-before': 'never-multi-line',
        'selector-list-comma-space-after': 'always-single-line',
        'selector-list-comma-space-before': 'never',
        'at-rule-empty-line-before': [
            'always',
            {
                except: [
                    'after-same-name',
                    'inside-block',
                    'blockless-after-same-name-blockless',
                    'blockless-after-blockless',
                    'first-nested',
                ],
            },
        ],
        'rule-empty-line-before': [
            'always',
            {
                except: ['first-nested'],
                ignore: ['after-comment'],
            },
        ],
        'media-feature-colon-space-after': 'always',
        'media-feature-colon-space-before': 'never',
        'media-feature-name-case': 'lower',
        'media-feature-parentheses-space-inside': 'never',
        'media-feature-range-operator-space-after': 'always',
        'media-feature-range-operator-space-before': 'always',
        'media-query-list-comma-newline-after': 'never-multi-line',
        'media-query-list-comma-newline-before': 'never-multi-line',
        'media-query-list-comma-space-after': 'always',
        'media-query-list-comma-space-before': 'never',
        'at-rule-name-space-after': 'always',
        'at-rule-semicolon-newline-after': 'always',
        'at-rule-semicolon-space-before': 'never',
        'comment-empty-line-before': [
            'always',
            {
                except: ['first-nested'],
                ignore: ['after-comment', 'stylelint-commands'],
            },
        ],
    },
};
